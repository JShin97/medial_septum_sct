Job 2607139 started on:    g12
Job 2607139 started on:    Mon Apr 8 10:12:02 PDT 2024
 
cellbender:remove-background: Command:
cellbender remove-background --input /u/home/j/jshin/scratch/medial_septum_sct/Data/Raw/Counts/TriSeptum-3/outs/raw_feature_bc_matrix.h5 --output TriSeptum-3.h5 --cuda
cellbender:remove-background: CellBender 0.3.0
cellbender:remove-background: (Workflow hash 100b8268d3)
cellbender:remove-background: 2024-04-08 10:12:10
cellbender:remove-background: Running remove-background
cellbender:remove-background: Loading data from /u/home/j/jshin/scratch/medial_septum_sct/Data/Raw/Counts/TriSeptum-3/outs/raw_feature_bc_matrix.h5
cellbender:remove-background: CellRanger v3 format
cellbender:remove-background: Features in dataset: 32285 Gene Expression
cellbender:remove-background: Trimming features for inference.
cellbender:remove-background: 26273 features have nonzero counts.
cellbender:remove-background: Prior on counts for cells is 5387
cellbender:remove-background: Prior on counts for empty droplets is 804
cellbender:remove-background: Excluding 4474 features that are estimated to have <= 0.1 background counts in cells.
cellbender:remove-background: Including 21799 features in the analysis.
cellbender:remove-background: Trimming barcodes for inference.
cellbender:remove-background: Excluding barcodes with counts below 402
cellbender:remove-background: Using 2527 probable cell barcodes, plus an additional 10165 barcodes, and 73487 empty droplets.
cellbender:remove-background: Largest surely-empty droplet has 1085 UMI counts.
cellbender:remove-background: Attempting to unpack tarball "ckpt.tar.gz" to /work/2607139.4.gpu_RTX2080Ti.q/tmpyhxpr9s5
cellbender:remove-background: No saved checkpoint.
cellbender:remove-background: No checkpoint loaded.
cellbender:remove-background: Running inference...
cellbender:remove-background: [epoch 001]  average training loss: 7353.3425
cellbender:remove-background: [epoch 002]  average training loss: 6784.5301  (8.4 seconds per epoch)
cellbender:remove-background: Will checkpoint every 51 epochs
cellbender:remove-background: [epoch 003]  average training loss: 6218.8914
cellbender:remove-background: [epoch 004]  average training loss: 5894.8417
cellbender:remove-background: [epoch 005]  average training loss: 5687.4191
cellbender:remove-background: [epoch 005] average test loss: 5665.8540
cellbender:remove-background: [epoch 006]  average training loss: 5492.5122
cellbender:remove-background: [epoch 007]  average training loss: 5438.0742
cellbender:remove-background: [epoch 008]  average training loss: 5438.7427
cellbender:remove-background: [epoch 009]  average training loss: 5399.0881
cellbender:remove-background: [epoch 010]  average training loss: 5399.2381
cellbender:remove-background: [epoch 010] average test loss: 5445.5591
cellbender:remove-background: [epoch 011]  average training loss: 5439.7627
cellbender:remove-background: [epoch 012]  average training loss: 5396.6107
cellbender:remove-background: [epoch 013]  average training loss: 5401.2342
cellbender:remove-background: [epoch 014]  average training loss: 5387.2982
cellbender:remove-background: [epoch 015]  average training loss: 5374.9357
cellbender:remove-background: [epoch 015] average test loss: 5391.3284
cellbender:remove-background: [epoch 016]  average training loss: 5378.8558
cellbender:remove-background: [epoch 017]  average training loss: 5385.0952
cellbender:remove-background: [epoch 018]  average training loss: 5362.1889
cellbender:remove-background: [epoch 019]  average training loss: 5356.3995
cellbender:remove-background: [epoch 020]  average training loss: 5325.2083
cellbender:remove-background: [epoch 020] average test loss: 5336.8802
cellbender:remove-background: [epoch 021]  average training loss: 5291.6348
cellbender:remove-background: [epoch 022]  average training loss: 5268.9264
cellbender:remove-background: [epoch 023]  average training loss: 5254.0363
cellbender:remove-background: [epoch 024]  average training loss: 5244.1550
cellbender:remove-background: [epoch 025]  average training loss: 5254.6955
cellbender:remove-background: [epoch 025] average test loss: 5178.6549
cellbender:remove-background: [epoch 026]  average training loss: 5253.0901
cellbender:remove-background: [epoch 027]  average training loss: 5242.2805
cellbender:remove-background: [epoch 028]  average training loss: 5237.4342
cellbender:remove-background: [epoch 029]  average training loss: 5233.0725
cellbender:remove-background: [epoch 030]  average training loss: 5246.1504
cellbender:remove-background: [epoch 030] average test loss: 5189.8583
cellbender:remove-background: [epoch 031]  average training loss: 5255.0703
cellbender:remove-background: [epoch 032]  average training loss: 5347.4184
cellbender:remove-background: [epoch 033]  average training loss: 5501.3913
cellbender:remove-background: [epoch 034]  average training loss: 5501.9860
cellbender:remove-background: [epoch 035]  average training loss: 5506.5299
cellbender:remove-background: [epoch 035] average test loss: 5455.6253
cellbender:remove-background: [epoch 036]  average training loss: 5510.4124
cellbender:remove-background: [epoch 037]  average training loss: 5502.2534
cellbender:remove-background: [epoch 038]  average training loss: 5509.9079
cellbender:remove-background: [epoch 039]  average training loss: 5490.8061
cellbender:remove-background: [epoch 040]  average training loss: 5483.9778
cellbender:remove-background: [epoch 040] average test loss: 5461.9737
cellbender:remove-background: [epoch 041]  average training loss: 5491.7663
cellbender:remove-background: [epoch 042]  average training loss: 5481.2532
cellbender:remove-background: [epoch 043]  average training loss: 5480.6946
cellbender:remove-background: [epoch 044]  average training loss: 5471.3303
cellbender:remove-background: [epoch 045]  average training loss: 5475.4583
cellbender:remove-background: [epoch 045] average test loss: 5411.3152
cellbender:remove-background: [epoch 046]  average training loss: 5472.6199
cellbender:remove-background: [epoch 047]  average training loss: 5470.7074
cellbender:remove-background: [epoch 048]  average training loss: 5474.5138
cellbender:remove-background: [epoch 049]  average training loss: 5458.7411
cellbender:remove-background: [epoch 050]  average training loss: 5463.6762
cellbender:remove-background: [epoch 050] average test loss: 5423.4793
cellbender:remove-background: [epoch 051]  average training loss: 5451.0801
cellbender:remove-background: Saving a checkpoint...
cellbender:remove-background: Saved checkpoint as /u/scratch/j/jshin/medial_septum_sct/Data/Raw/Cellbender_counts2/TriSeptum-3/ckpt.tar.gz
cellbender:remove-background: [epoch 052]  average training loss: 5460.8465
cellbender:remove-background: [epoch 053]  average training loss: 5456.7972
cellbender:remove-background: [epoch 054]  average training loss: 5449.2432
cellbender:remove-background: [epoch 055]  average training loss: 5445.2960
cellbender:remove-background: [epoch 055] average test loss: 5379.5896
cellbender:remove-background: [epoch 056]  average training loss: 5448.9968
cellbender:remove-background: [epoch 057]  average training loss: 5446.5798
cellbender:remove-background: [epoch 058]  average training loss: 5443.9974
cellbender:remove-background: [epoch 059]  average training loss: 5431.5486
cellbender:remove-background: [epoch 060]  average training loss: 5445.1936
cellbender:remove-background: [epoch 060] average test loss: 5433.7511
cellbender:remove-background: [epoch 061]  average training loss: 5433.4850
cellbender:remove-background: [epoch 062]  average training loss: 5439.5460
cellbender:remove-background: [epoch 063]  average training loss: 5431.2051
cellbender:remove-background: [epoch 064]  average training loss: 5417.4449
cellbender:remove-background: [epoch 065]  average training loss: 5420.5509
cellbender:remove-background: [epoch 065] average test loss: 5387.5206
cellbender:remove-background: [epoch 066]  average training loss: 5418.4183
cellbender:remove-background: [epoch 067]  average training loss: 5426.2698
cellbender:remove-background: [epoch 068]  average training loss: 5421.9963
cellbender:remove-background: [epoch 069]  average training loss: 5411.2314
cellbender:remove-background: [epoch 070]  average training loss: 5405.2809
cellbender:remove-background: [epoch 070] average test loss: 5350.6553
cellbender:remove-background: [epoch 071]  average training loss: 5413.4990
cellbender:remove-background: [epoch 072]  average training loss: 5418.2486
cellbender:remove-background: [epoch 073]  average training loss: 5413.0188
cellbender:remove-background: [epoch 074]  average training loss: 5416.5505
cellbender:remove-background: [epoch 075]  average training loss: 5412.2715
cellbender:remove-background: [epoch 075] average test loss: 5403.9564
cellbender:remove-background: [epoch 076]  average training loss: 5411.6178
cellbender:remove-background: [epoch 077]  average training loss: 5407.1570
cellbender:remove-background: [epoch 078]  average training loss: 5404.4006
cellbender:remove-background: [epoch 079]  average training loss: 5406.9534
cellbender:remove-background: [epoch 080]  average training loss: 5412.7021
cellbender:remove-background: [epoch 080] average test loss: 5340.5762
cellbender:remove-background: [epoch 081]  average training loss: 5403.8883
cellbender:remove-background: [epoch 082]  average training loss: 5405.8618
cellbender:remove-background: [epoch 083]  average training loss: 5398.3536
cellbender:remove-background: [epoch 084]  average training loss: 5399.7288
cellbender:remove-background: [epoch 085]  average training loss: 5391.7218
cellbender:remove-background: [epoch 085] average test loss: 5387.6791
cellbender:remove-background: [epoch 086]  average training loss: 5393.4683
cellbender:remove-background: [epoch 087]  average training loss: 5397.0892
cellbender:remove-background: [epoch 088]  average training loss: 5397.7328
cellbender:remove-background: [epoch 089]  average training loss: 5404.6120
cellbender:remove-background: [epoch 090]  average training loss: 5393.9727
cellbender:remove-background: [epoch 090] average test loss: 5375.0827
cellbender:remove-background: [epoch 091]  average training loss: 5394.9220
cellbender:remove-background: [epoch 092]  average training loss: 5398.6612
cellbender:remove-background: [epoch 093]  average training loss: 5399.8572
cellbender:remove-background: [epoch 094]  average training loss: 5389.5497
cellbender:remove-background: [epoch 095]  average training loss: 5395.7606
cellbender:remove-background: [epoch 095] average test loss: 5375.0123
cellbender:remove-background: [epoch 096]  average training loss: 5384.0915
cellbender:remove-background: [epoch 097]  average training loss: 5395.4258
cellbender:remove-background: [epoch 098]  average training loss: 5393.4374
cellbender:remove-background: [epoch 099]  average training loss: 5392.1287
cellbender:remove-background: [epoch 100]  average training loss: 5384.2902
cellbender:remove-background: [epoch 100] average test loss: 5354.8058
cellbender:remove-background: [epoch 101]  average training loss: 5390.0940
cellbender:remove-background: [epoch 102]  average training loss: 5392.5070
cellbender:remove-background: Saving a checkpoint...
cellbender:remove-background: Saved checkpoint as /u/scratch/j/jshin/medial_septum_sct/Data/Raw/Cellbender_counts2/TriSeptum-3/ckpt.tar.gz
cellbender:remove-background: [epoch 103]  average training loss: 5387.5100
cellbender:remove-background: [epoch 104]  average training loss: 5393.8646
cellbender:remove-background: [epoch 105]  average training loss: 5387.4095
cellbender:remove-background: [epoch 105] average test loss: 5343.1766
cellbender:remove-background: [epoch 106]  average training loss: 5391.2282
cellbender:remove-background: [epoch 107]  average training loss: 5401.5699
cellbender:remove-background: [epoch 108]  average training loss: 5393.0584
cellbender:remove-background: [epoch 109]  average training loss: 5373.5730
cellbender:remove-background: [epoch 110]  average training loss: 5395.2675
cellbender:remove-background: [epoch 110] average test loss: 5362.5328
cellbender:remove-background: [epoch 111]  average training loss: 5383.3232
cellbender:remove-background: [epoch 112]  average training loss: 5391.2176
cellbender:remove-background: [epoch 113]  average training loss: 5379.2169
cellbender:remove-background: [epoch 114]  average training loss: 5387.1286
cellbender:remove-background: [epoch 115]  average training loss: 5381.4720
cellbender:remove-background: [epoch 115] average test loss: 5360.1646
cellbender:remove-background: [epoch 116]  average training loss: 5382.0978
cellbender:remove-background: [epoch 117]  average training loss: 5390.6610
cellbender:remove-background: [epoch 118]  average training loss: 5388.4986
cellbender:remove-background: [epoch 119]  average training loss: 5374.9747
cellbender:remove-background: [epoch 120]  average training loss: 5380.1523
cellbender:remove-background: [epoch 120] average test loss: 5355.3998
cellbender:remove-background: [epoch 121]  average training loss: 5380.4442
cellbender:remove-background: [epoch 122]  average training loss: 5398.2252
cellbender:remove-background: [epoch 123]  average training loss: 5389.0317
cellbender:remove-background: [epoch 124]  average training loss: 5384.3830
cellbender:remove-background: [epoch 125]  average training loss: 5387.2537
cellbender:remove-background: [epoch 125] average test loss: 5357.7070
cellbender:remove-background: [epoch 126]  average training loss: 5390.0837
cellbender:remove-background: [epoch 127]  average training loss: 5380.7485
cellbender:remove-background: [epoch 128]  average training loss: 5382.6343
cellbender:remove-background: [epoch 129]  average training loss: 5386.0726
cellbender:remove-background: [epoch 130]  average training loss: 5374.0914
cellbender:remove-background: [epoch 130] average test loss: 5353.4074
cellbender:remove-background: [epoch 131]  average training loss: 5383.8812
cellbender:remove-background: [epoch 132]  average training loss: 5379.9146
cellbender:remove-background: [epoch 133]  average training loss: 5388.4694
cellbender:remove-background: [epoch 134]  average training loss: 5377.4024
cellbender:remove-background: [epoch 135]  average training loss: 5384.3434
cellbender:remove-background: [epoch 135] average test loss: 5342.1077
cellbender:remove-background: [epoch 136]  average training loss: 5380.2991
cellbender:remove-background: [epoch 137]  average training loss: 5386.0236
cellbender:remove-background: [epoch 138]  average training loss: 5379.8210
cellbender:remove-background: [epoch 139]  average training loss: 5380.1325
cellbender:remove-background: [epoch 140]  average training loss: 5384.3300
cellbender:remove-background: [epoch 140] average test loss: 5345.2139
cellbender:remove-background: [epoch 141]  average training loss: 5384.4324
cellbender:remove-background: [epoch 142]  average training loss: 5384.5401
cellbender:remove-background: [epoch 143]  average training loss: 5382.8495
cellbender:remove-background: [epoch 144]  average training loss: 5378.2261
cellbender:remove-background: [epoch 145]  average training loss: 5379.5817
cellbender:remove-background: [epoch 145] average test loss: 5355.6955
cellbender:remove-background: [epoch 146]  average training loss: 5382.7470
cellbender:remove-background: [epoch 147]  average training loss: 5381.5821
cellbender:remove-background: [epoch 148]  average training loss: 5382.5868
cellbender:remove-background: [epoch 149]  average training loss: 5381.8111
cellbender:remove-background: [epoch 150]  average training loss: 5379.7016
cellbender:remove-background: [epoch 150] average test loss: 5346.1039
cellbender:remove-background: Saving a checkpoint...
cellbender:remove-background: Saved checkpoint as /u/scratch/j/jshin/medial_septum_sct/Data/Raw/Cellbender_counts2/TriSeptum-3/ckpt.tar.gz
cellbender:remove-background: 2024-04-08 10:33:43
cellbender:remove-background: Inference procedure complete.
cellbender:remove-background: Attempting to unpack tarball "ckpt.tar.gz" to /work/2607139.4.gpu_RTX2080Ti.q/tmpoxwolt0q
cellbender:remove-background: Successfully unpacked tarball to /work/2607139.4.gpu_RTX2080Ti.q/tmpoxwolt0q
/work/2607139.4.gpu_RTX2080Ti.q/tmpoxwolt0q/100b8268d3_random.pyro
/work/2607139.4.gpu_RTX2080Ti.q/tmpoxwolt0q/100b8268d3_train.loaderstate
/work/2607139.4.gpu_RTX2080Ti.q/tmpoxwolt0q/100b8268d3_random.cuda
/work/2607139.4.gpu_RTX2080Ti.q/tmpoxwolt0q/100b8268d3_optim.torch
/work/2607139.4.gpu_RTX2080Ti.q/tmpoxwolt0q/100b8268d3_test.loaderstate
/work/2607139.4.gpu_RTX2080Ti.q/tmpoxwolt0q/100b8268d3_params.pyro
/work/2607139.4.gpu_RTX2080Ti.q/tmpoxwolt0q/100b8268d3_model.torch
/work/2607139.4.gpu_RTX2080Ti.q/tmpoxwolt0q/100b8268d3_args.npy
/work/2607139.4.gpu_RTX2080Ti.q/tmpoxwolt0q/100b8268d3_optim.pyro
cellbender:remove-background: Posterior not currently included in checkpoint.
cellbender:remove-background: Computing posterior noise count probabilities in mini-batches.
cellbender:remove-background: Working on chunk (1/98)
Traceback (most recent call last):
  File "/u/home/j/jshin/.conda/envs/cellbender/bin/cellbender", line 8, in <module>
    sys.exit(main())
  File "/u/home/j/jshin/.conda/envs/cellbender/lib/python3.7/site-packages/cellbender/base_cli.py", line 118, in main
    cli_dict[args.tool].run(args)
  File "/u/home/j/jshin/.conda/envs/cellbender/lib/python3.7/site-packages/cellbender/remove_background/cli.py", line 185, in run
    return main(args)
  File "/u/home/j/jshin/.conda/envs/cellbender/lib/python3.7/site-packages/cellbender/remove_background/cli.py", line 230, in main
    posterior = run_remove_background(args)
  File "/u/home/j/jshin/.conda/envs/cellbender/lib/python3.7/site-packages/cellbender/remove_background/run.py", line 107, in run_remove_background
    args=args,
  File "/u/home/j/jshin/.conda/envs/cellbender/lib/python3.7/site-packages/cellbender/remove_background/posterior.py", line 125, in load_or_compute_posterior_and_save
    posterior.cell_noise_count_posterior_coo()
  File "/u/home/j/jshin/.conda/envs/cellbender/lib/python3.7/site-packages/cellbender/remove_background/posterior.py", line 386, in cell_noise_count_posterior_coo
    self._get_cell_noise_count_posterior_coo(**kwargs)
  File "/u/home/j/jshin/.conda/envs/cellbender/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/u/home/j/jshin/.conda/envs/cellbender/lib/python3.7/site-packages/cellbender/remove_background/posterior.py", line 491, in _get_cell_noise_count_posterior_coo
    n_counts_max=n_counts_max,
  File "/u/home/j/jshin/.conda/envs/cellbender/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/u/home/j/jshin/.conda/envs/cellbender/lib/python3.7/site-packages/cellbender/remove_background/posterior.py", line 684, in noise_log_pdf
    debug=self.debug,
  File "/u/home/j/jshin/.conda/envs/cellbender/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/u/home/j/jshin/.conda/envs/cellbender/lib/python3.7/site-packages/cellbender/remove_background/posterior.py", line 814, in _log_prob_noise_count_tensor
    .log_prob(data.unsqueeze(-1) - noise_count_tensor))
  File "/u/home/j/jshin/.conda/envs/cellbender/lib/python3.7/site-packages/torch/distributions/negative_binomial.py", line 102, in log_prob
    log_normalization = (-torch.lgamma(self.total_count + value) + torch.lgamma(1. + value) +
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 214.00 MiB (GPU 0; 10.75 GiB total capacity; 2.22 GiB already allocated; 28.50 MiB free; 2.33 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Job 2607139 ended on:    g12
Job 2607139 ended on:    Mon Apr 8 10:34:02 PDT 2024
 
